function vbar = rigidvelocity(angle, degM)


Data_v_rigid = ...
    [0.200000000000000,0.0341637677570619;
    0.210000000000000,0.0318121040840313;
    0.220000000000000,0.0294604404110007;
    0.230000000000000,0.0214652061331165;
    0.240000000000000,0.0134699718552322;
    0.250000000000000,0.0270376920725172;
    0.260000000000000,0.0406054122898022;
    0.270000000000000,0.0493926428605811;
    0.280000000000000,0.0581798734313600;
    0.290000000000000,0.0727815589557898;
    0.300000000000000,0.0873832444802196;
    0.310000000000000,0.120480003781934;
    0.320000000000000,0.153576763083649;
    0.330000000000000,0.121298327761817;
    0.340000000000000,0.0890198924399857;
    0.350000000000000,0.0593793396552426;
    0.360000000000000,0.0297387868704994;
    0.370000000000000,0.0523885078296510;
    0.380000000000000,0.0750382287888026;
    0.390000000000000,0.0839423958965272;
    0.400000000000000,0.0928465630042518;
    0.405000000000000,0.0934232815021259;
    0.410000000000000,0.0940000000000000;
    0.415000000000000,0.0920450901531557;
    0.420000000000000,0.0900901803063113;
    0.430000000000000,0.0821537400622732;
    0.440000000000000,0.0742172998182350;
    0.450000000000000,0.0642625460180520;
    0.460000000000000,0.0543077922178689;
    0.470000000000000,0.0435862743034847;
    0.480000000000000,0.0328647563891005;
    0.490000000000000,0.0198793455167777;
    0.500000000000000,0.00689393464445489;
    0.510000000000000,0.0259182257255023;
    0.520000000000000,0.0449425168065497;
    0.530000000000000,0.0878974236659084;0.540000000000000,0.130852330525267;0.550000000000000,0.187799089139288;0.560000000000000,0.244745847753308;0.570000000000000,0.277920439846192;0.580000000000000,0.311095031939076;0.585000000000000,0.320547515969538;0.590000000000000,0.330000000000000;0.595000000000000,0.313097924809996;0.600000000000000,0.296195849619991;0.610000000000000,0.271464855839010;0.620000000000000,0.246733862058028;0.630000000000000,0.221944443937399;0.640000000000000,0.197155025816770;0.650000000000000,0.176838779601577;0.660000000000000,0.156522533386384;0.670000000000000,0.140600290894157;0.680000000000000,0.124678048401929;0.690000000000000,0.112225208489993;0.700000000000000,0.0997723685780567;0.710000000000000,0.0899590760595571;0.720000000000000,0.0801457835410575;0.730000000000000,0.0723590687429307;0.740000000000000,0.0645723539448040;0.750000000000000,0.0583720471468146;0.760000000000000,0.0521717403488251;0.770000000000000,0.0472347890206646;0.780000000000000,0.0422978376925040;0.790000000000000,0.0383778881707550;0.800000000000000,0.0344579386490059;0.810000000000000,0.0313594411179921;0.820000000000000,0.0282609435869782;0.830000000000000,0.0258231930787198;0.840000000000000,0.0233854425704614;0.850000000000000,0.0214728626929278;0.860000000000000,0.0195602828153942;0.870000000000000,0.0180564829120913;0.880000000000000,0.0165526830087883;0.890000000000000,0.0153567592081096;0.900000000000000,0.0141608354074309;0.910000000000000,0.0131849862666709;0.920000000000000,0.0122091371259109;0.930000000000000,0.0113770235042522;0.940000000000000,0.0105449098825935;0.950000000000000,0.00979044701233578;0.960000000000000,0.00903598414207806;0.970000000000000,0.00830237827152006;0.980000000000000,0.00756877240096207;0.990000000000000,0.00680770517125675;1,0.00604663794155143;1.01000000000000,0.00521757206709163;1.02000000000000,0.00438850619263182;1.03000000000000,0.00345832760510499;1.04000000000000,0.00252814901757815;1.05000000000000,0.00148170811554333;1.06000000000000,0.000435267213508502;1.07000000000000,0.00123166874907041;1.08000000000000,0.00202807028463232;1.09000000000000,0.00340478999965913;1.10000000000000,0.00478150971468593;1.11000000000000,0.00633892369369820;1.12000000000000,0.00789633767271048;1.13000000000000,0.00964136149887399;1.14000000000000,0.0113863853250375;1.15000000000000,0.0133234105751112;1.16000000000000,0.0152604358251848;1.17000000000000,0.0173910128359536;1.18000000000000,0.0195215898467223;1.19000000000000,0.0218447679087753;1.20000000000000,0.0241679459708282;1.21000000000000,0.0266806524604170;1.22000000000000,0.0291933589500058;1.23000000000000,0.0318907551458792;1.24000000000000,0.0345881513417527;1.25000000000000,0.0374639521117981;1.26000000000000,0.0403397528818435;1.27000000000000,0.0433865179906994;1.28000000000000,0.0464332830995552;1.29000000000000,0.0496426688691308;1.30000000000000,0.0528520546387063;1.31000000000000,0.0562150428568405;1.32000000000000,0.0595780310749746;1.33000000000000,0.0630851196620921;1.34000000000000,0.0665922082492096;1.35000000000000,0.0702335834514210;1.36000000000000,0.0738749586536324;1.37000000000000,0.0776406376846415;1.38000000000000,0.0814063167156505;1.39000000000000,0.0852862714329168;1.40000000000000,0.0891662261501831;1.41000000000000,0.0931504844833204;1.42000000000000,0.0971347428164576;1.43000000000000,0.101213475191132;1.44000000000000,0.105292207565806;1.45000000000000,0.109455797598184;1.46000000000000,0.113619387630562;1.47000000000000,0.117858486670397;1.48000000000000,0.122097585710232;1.49000000000000,0.126403158088219;1.50000000000000,0.130708730466205;1.51000000000000,0.135072087977344;1.52000000000000,0.139435445488483;1.53000000000000,0.143848270956336;1.54000000000000,0.148261096424188;1.55000000000000,0.152715462894756;1.56000000000000,0.157169829365323;1.57000000000000,0.161658208398814;1.58000000000000,0.166146587432305;1.59000000000000,0.170661858072124;1.60000000000000,0.175177128711943;1.61000000000000,0.179712575012953;1.62000000000000,0.184248021313962;1.63000000000000,0.188797330786741;1.64000000000000,0.193346640259520;1.65000000000000,0.197903896818213;1.66000000000000,0.202461153376905;1.67000000000000,0.207020829924920;1.68000000000000,0.211580506472934;1.69000000000000,0.216137452632881;1.70000000000000,0.220694398792827;1.71000000000000,0.225243829685907;1.72000000000000,0.229793260578987;1.73000000000000,0.234330743129394;1.74000000000000,0.238868225679801;1.75000000000000,0.243389663278660;1.76000000000000,0.247911100877518;1.77000000000000,0.252412720295072;1.78000000000000,0.256914339712626;1.79000000000000,0.261392675442185;1.80000000000000,0.265871011171743;1.81000000000000,0.270322889024482;1.82000000000000,0.274774766877221;1.83000000000000,0.279197288714691;1.84000000000000,0.283619810552161;1.85000000000000,0.288010341769295;1.86000000000000,0.292400872986428;1.87000000000000,0.296757024248940;1.88000000000000,0.301113175511453;1.89000000000000,0.305432790306552;1.90000000000000,0.309752405101652;1.91000000000000,0.314033545555512;1.92000000000000,0.318314686009372;1.93000000000000,0.322555618232012;1.94000000000000,0.326796550454652;1.95000000000000,0.330995732351449;1.96000000000000,0.335194914248246;1.97000000000000,0.339350982810535;1.98000000000000,0.343507051372824;1.99000000000000,0.347618810876547;2,0.351730570380270];

degg = Data_v_rigid(:,1);
vbar = 0;

%Shift magic angle
temp = Data_v_rigid(:,2);
degM0 = degg(temp == min(temp));
if nargin < 2, degM = degM0; end
angle = angle - (degM - degM0);

w = 0.1217633;

fit1 = [0.141460628933869,-0.963917351401268,2.25177836285698,-1.74353326935604,-0.103533377188576,0.414767498794032];
fit2 = [-12.7993903350725,69.7414171123409,-150.608346042647,161.402187739808,-86.0310512560229,18.3008641297825];
fit3 = [308321.042111287,-841773.629317802,917679.558582021,-499337.936111109,135616.882253576,-14708.0755674407];
fit4 = [14118.0752563395,-33112.2601934891,31023.4129733813,-14517.7297982026,3393.03035803215,-316.676102893892];
fit5 = [11564.5026726930,-17790.3987959395,10226.1977662988,-2601.73313580814,247.127845304440];



if angle > 2
    vbar = vbarfun2(w,angle);
end


if angle >=degg(91) && angle <=degg(185)
    
    fitn1 = 5;
    %fit1 = polyfit(degg(91:185),vff(91:185),fitn1);
    for ii = 1:fitn1+1
        vbar = vbar + fit1(ii) .* angle.^(fitn1+1-ii);
    end
    
    
end

if angle >=degg(43) && angle <degg(91)
    fitn2 = 5;
    %fit2 = polyfit(degg(43:91),vff(43:91),fitn2);
    for ii = 1:fitn2+1
        vbar = vbar+ fit2(ii) .* angle.^(fitn2+1-ii);
    end
end


if angle >=degg(33) && angle <degg(43)
    fitn3 = 5;
    %fit3 = polyfit(degg(33:43),vff(33:43),fitn3);
    for ii = 1:fitn3+1
        vbar  =vbar+ fit3(ii) .* angle.^(fitn3+1-ii);
    end
    
end

if angle >=degg(23) && angle <degg(33)
    fitn4 = 5;
    %fit4 = polyfit(degg(23:33),vff(23:33),fitn4);
    for ii = 1:fitn4+1
        vbar = vbar + fit4(ii) .* angle.^(fitn4+1-ii);
    end
end


if angle >=degg(17) && angle <degg(23)
    fitn5 = 4;
    %fit5 = polyfit(degg(17:23),vff(17:23),fitn5);
    for ii = 1:fitn5+1
        vbar = vbar + fit5(ii) .* angle.^(fitn5+1-ii);
    end
end


end